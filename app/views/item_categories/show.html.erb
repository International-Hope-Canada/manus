<% if current_user.admin? %>
  <div class="page-actions">
    <p>
      <%= link_to 'Edit', edit_item_category_path(@item_category), class: "btn btn-primary" %>
      <%= link_to("Delete", @item_category, data: { turbo_method: :delete, turbo_confirm: "Delete this category and all its subcategories?" }) if @item_category.destroyable? %>
    </p>
  </div>
<% end %>

<table class="data-table">
  <tbody>
    <tr>
      <th>Classification</th>
      <td><%= @item_category.classification.capitalize %></td>
    </tr>
    <tr>
      <th>Value</th>
      <td class="numeric"><%= number_to_currency(@item_category.value) if @item_category.value %></td>
    </tr>
    <tr>
      <th>Weight (kg)</th>
      <td class="numeric"><%= @item_category.weight_kg %></td>
    </tr>
  </tbody>
</table>

<h2>Subcategories</h2>

<p>
  <%= link_to 'New', new_item_subcategory_path(item_category_id: @item_category.id), class: "btn btn-primary" %>
</p>

<% if @item_category.item_subcategories.any? %>
  <table class="data-table">
    <thead>
      <tr>
        <th>Name</th>
        <th>Active</th>
        <th class="numeric">Value</th>
        <th class="numeric">Weight (kg)</th>
      </tr>
    </thead>
    <tbody>
      <% @item_category.item_subcategories.order(active: :desc, name: :asc).each do |subcategory| %>
        <tr>
          <td><%= subcategory.name %></td>
          <td><%= render_boolean(subcategory.active) %></td>
          <td class="numeric">
            <%= number_to_currency(subcategory.value) if subcategory.value %>
            <% if subcategory.missing_value? %>
              <span class="saved-data-error">Missing value</span>
            <% end %>
          </td>
          <td class="numeric">
            <%= subcategory.weight_kg %>
            <% if subcategory.missing_weight? %>
              <span class="saved-data-error">Missing weight</span>
            <% end %>
          </td>
          <td class="action-column">
            <%= link_to('ðŸ”Ž', subcategory, title: 'View') %>
          </td>
          <% if current_user.admin? %>
            <td class="action-column">
              <%= link_to('âœŽ', edit_item_subcategory_path(subcategory), title: 'Edit') %>
            </td>
            <td class="action-column">
              <%= link_to("ðŸ—‘", subcategory, title: 'Delete', data: { turbo_method: :delete, turbo_confirm: "Delete this subcategory?" }) if subcategory.destroyable? %>
            </td>
          <% end %>
        </tr>
      <% end %>
    </tbody>
  </table>
<% else %>
  <p><span class="saved-data-error">Missing subcategories!</span></p>
<% end %>